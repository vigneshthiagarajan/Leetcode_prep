# Write your MySQL query statement below
# SELECT DISTINCT PERSON1, PERSON2, COUNT(C.DURATION) AS CALL_COUNT, SUM(C.DURATION) AS TOTAL_DURATION
# FROM
# (SELECT
# (CASE WHEN FROM_ID < TO_ID THEN FROM_ID ELSE TO_ID END) AS PERSON1,
# (CASE WHEN FROM_ID < TO_ID THEN TO_ID ELSE FROM_ID END) AS PERSON2,
# DURATION
# FROM CALLS) C
# GROUP BY PERSON1, PERSON2
# ORDER BY PERSON1


WITH TEMP AS (SELECT
(CASE WHEN FROM_ID < TO_ID THEN FROM_ID ELSE TO_ID END) AS PERSON1,
(CASE WHEN FROM_ID < TO_ID THEN TO_ID ELSE FROM_ID END) AS PERSON2,
DURATION FROM CALLS C)
SELECT DISTINCT PERSON1, PERSON2, COUNT(DURATION) AS CALL_COUNT, SUM(DURATION) AS TOTAL_DURATION FROM TEMP GROUP BY PERSON1, PERSON2;
